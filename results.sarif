{"$schema": "https://raw.githubusercontent.com/oasis-tcs/sarif-spec/master/Schemata/sarif-schema-2.1.0.json", "version": "2.1.0", "runs": [{"tool": {"driver": {"name": "Checkov", "version": "3.2.31", "informationUri": "https://checkov.io", "rules": [{"id": "CKV_AWS_109", "name": "Ensure IAM policies does not allow permissions management / resource exposure without constraints", "shortDescription": {"text": "Ensure IAM policies does not allow permissions management / resource exposure without constraints"}, "fullDescription": {"text": "Ensure IAM policies does not allow permissions management / resource exposure without constraints"}, "help": {"text": "Ensure IAM policies does not allow permissions management / resource exposure without constraints\nResource: aws_iam_policy_document.fail1"}, "defaultConfiguration": {"level": "error"}}, {"id": "CKV_AWS_283", "name": "Ensure no IAM policies documents allow ALL or any AWS principal permissions to the resource", "shortDescription": {"text": "Ensure no IAM policies documents allow ALL or any AWS principal permissions to the resource"}, "fullDescription": {"text": "Ensure no IAM policies documents allow ALL or any AWS principal permissions to the resource"}, "help": {"text": "Ensure no IAM policies documents allow ALL or any AWS principal permissions to the resource\nResource: aws_iam_policy_document.fail1"}, "defaultConfiguration": {"level": "error"}}, {"id": "CKV_AWS_356", "name": "Ensure no IAM policies documents allow \"*\" as a statement's resource for restrictable actions", "shortDescription": {"text": "Ensure no IAM policies documents allow \"*\" as a statement's resource for restrictable actions"}, "fullDescription": {"text": "Ensure no IAM policies documents allow \"*\" as a statement's resource for restrictable actions"}, "help": {"text": "Ensure no IAM policies documents allow \"*\" as a statement's resource for restrictable actions\nResource: aws_iam_policy_document.fail1"}, "defaultConfiguration": {"level": "error"}}, {"id": "CKV_AWS_111", "name": "Ensure IAM policies does not allow write access without constraints", "shortDescription": {"text": "Ensure IAM policies does not allow write access without constraints"}, "fullDescription": {"text": "Ensure IAM policies does not allow write access without constraints"}, "help": {"text": "Ensure IAM policies does not allow write access without constraints\nResource: aws_iam_policy_document.fail1"}, "defaultConfiguration": {"level": "error"}}, {"id": "CKV_AWS_7", "name": "Ensure rotation for customer created CMKs is enabled", "shortDescription": {"text": "Ensure rotation for customer created CMKs is enabled"}, "fullDescription": {"text": "Ensure rotation for customer created CMKs is enabled"}, "help": {"text": "Ensure rotation for customer created CMKs is enabled\nResource: aws_kms_key.pass2"}, "defaultConfiguration": {"level": "error"}}, {"id": "CKV_AWS_227", "name": "Ensure KMS key is enabled", "shortDescription": {"text": "Ensure KMS key is enabled"}, "fullDescription": {"text": "Ensure KMS key is enabled"}, "help": {"text": "Ensure KMS key is enabled\nResource: aws_kms_key.pass3"}, "defaultConfiguration": {"level": "error"}}, {"id": "CKV_AWS_33", "name": "Ensure KMS key policy does not contain wildcard (*) principal", "shortDescription": {"text": "Ensure KMS key policy does not contain wildcard (*) principal"}, "fullDescription": {"text": "Ensure KMS key policy does not contain wildcard (*) principal"}, "help": {"text": "Ensure KMS key policy does not contain wildcard (*) principal\nResource: aws_kms_key.pass3"}, "defaultConfiguration": {"level": "error"}}], "organization": "bridgecrew"}}, "results": [{"ruleId": "CKV_AWS_109", "ruleIndex": 0, "level": "error", "attachments": [], "message": {"text": "Ensure IAM policies does not allow permissions management / resource exposure without constraints"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "kms.tf"}, "region": {"startLine": 135, "endLine": 153, "snippet": {"text": "data \"aws_iam_policy_document\" \"fail1\" {\n\n  statement {\n    principals {\n      type = \"AWS\"\n      identifiers = [\n        \"*\"\n      ]\n    }\n    effect = \"Allow\"\n    actions = [\n      \"kms:*\"\n    ]\n    resources = [\n      \"*\",\n    ]\n  }\n\n}\n"}}}}]}, {"ruleId": "CKV_AWS_283", "ruleIndex": 1, "level": "error", "attachments": [], "message": {"text": "Ensure no IAM policies documents allow ALL or any AWS principal permissions to the resource"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "kms.tf"}, "region": {"startLine": 135, "endLine": 153, "snippet": {"text": "data \"aws_iam_policy_document\" \"fail1\" {\n\n  statement {\n    principals {\n      type = \"AWS\"\n      identifiers = [\n        \"*\"\n      ]\n    }\n    effect = \"Allow\"\n    actions = [\n      \"kms:*\"\n    ]\n    resources = [\n      \"*\",\n    ]\n  }\n\n}\n"}}}}]}, {"ruleId": "CKV_AWS_356", "ruleIndex": 2, "level": "error", "attachments": [], "message": {"text": "Ensure no IAM policies documents allow \"*\" as a statement's resource for restrictable actions"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "kms.tf"}, "region": {"startLine": 135, "endLine": 153, "snippet": {"text": "data \"aws_iam_policy_document\" \"fail1\" {\n\n  statement {\n    principals {\n      type = \"AWS\"\n      identifiers = [\n        \"*\"\n      ]\n    }\n    effect = \"Allow\"\n    actions = [\n      \"kms:*\"\n    ]\n    resources = [\n      \"*\",\n    ]\n  }\n\n}\n"}}}}]}, {"ruleId": "CKV_AWS_111", "ruleIndex": 3, "level": "error", "attachments": [], "message": {"text": "Ensure IAM policies does not allow write access without constraints"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "kms.tf"}, "region": {"startLine": 135, "endLine": 153, "snippet": {"text": "data \"aws_iam_policy_document\" \"fail1\" {\n\n  statement {\n    principals {\n      type = \"AWS\"\n      identifiers = [\n        \"*\"\n      ]\n    }\n    effect = \"Allow\"\n    actions = [\n      \"kms:*\"\n    ]\n    resources = [\n      \"*\",\n    ]\n  }\n\n}\n"}}}}]}, {"ruleId": "CKV_AWS_7", "ruleIndex": 4, "level": "error", "attachments": [], "message": {"text": "Ensure rotation for customer created CMKs is enabled"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "kms.tf"}, "region": {"startLine": 56, "endLine": 58, "snippet": {"text": "resource \"aws_kms_key\" \"pass2\" {\n  description = \"fail5\"\n}\n"}}}}]}, {"ruleId": "CKV_AWS_227", "ruleIndex": 5, "level": "error", "attachments": [], "message": {"text": "Ensure KMS key is enabled"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "kms.tf"}, "region": {"startLine": 85, "endLine": 133, "snippet": {"text": "resource \"aws_kms_key\" \"pass3\" {\n  description                        = \"pass3\"\n  deletion_window_in_days            = 7\n  key_usage                          = \"ENCRYPT_DECRYPT\"\n  customer_master_key_spec           = \"SYMMETRIC_DEFAULT\"\n  policy                             = <<POLICY\n{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Sid\": \"pass3\",\n            \"Effect\": \"Allow\",\n            \"Principal\": {\n                \"AWS\": \"*\"\n            },\n            \"Action\": [\n              \"kms:Update*\",\n              \"kms:UntagResource\",\n              \"kms:TagResource\",\n              \"kms:SynchronizeMultiRegionKey\",\n              \"kms:ScheduleKeyDeletion\",\n              \"kms:ReplicateKey\",\n              \"kms:PutKeyPolicy\",\n              \"kms:List*\",\n              \"kms:Get*\",\n              \"kms:Enable*\",\n              \"kms:Disable*\",\n              \"kms:Describe*\",\n              \"kms:DeleteAlias\",\n              \"kms:CreateAlias\",\n              \"kms:CancelKeyDeletion\"\n            ],\n            \"Resource\": \"*\",\n            \"Condition\": {\n                \"StringEquals\": {\n                    \"aws:PrincipalArn\": [\n                        \"${data.aws_iam_session_context.current.issuer_arn}\"\n                    ]\n                }\n            }\n        }\n    ]\n}\nPOLICY\n  bypass_policy_lockout_safety_check = false\n  is_enabled                         = false\n  enable_key_rotation                = true\n\n}\n"}}}}]}, {"ruleId": "CKV_AWS_33", "ruleIndex": 6, "level": "error", "attachments": [], "message": {"text": "Ensure KMS key policy does not contain wildcard (*) principal"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "kms.tf"}, "region": {"startLine": 85, "endLine": 133, "snippet": {"text": "resource \"aws_kms_key\" \"pass3\" {\n  description                        = \"pass3\"\n  deletion_window_in_days            = 7\n  key_usage                          = \"ENCRYPT_DECRYPT\"\n  customer_master_key_spec           = \"SYMMETRIC_DEFAULT\"\n  policy                             = <<POLICY\n{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Sid\": \"pass3\",\n            \"Effect\": \"Allow\",\n            \"Principal\": {\n                \"AWS\": \"*\"\n            },\n            \"Action\": [\n              \"kms:Update*\",\n              \"kms:UntagResource\",\n              \"kms:TagResource\",\n              \"kms:SynchronizeMultiRegionKey\",\n              \"kms:ScheduleKeyDeletion\",\n              \"kms:ReplicateKey\",\n              \"kms:PutKeyPolicy\",\n              \"kms:List*\",\n              \"kms:Get*\",\n              \"kms:Enable*\",\n              \"kms:Disable*\",\n              \"kms:Describe*\",\n              \"kms:DeleteAlias\",\n              \"kms:CreateAlias\",\n              \"kms:CancelKeyDeletion\"\n            ],\n            \"Resource\": \"*\",\n            \"Condition\": {\n                \"StringEquals\": {\n                    \"aws:PrincipalArn\": [\n                        \"${data.aws_iam_session_context.current.issuer_arn}\"\n                    ]\n                }\n            }\n        }\n    ]\n}\nPOLICY\n  bypass_policy_lockout_safety_check = false\n  is_enabled                         = false\n  enable_key_rotation                = true\n\n}\n"}}}}]}, {"ruleId": "CKV_AWS_7", "ruleIndex": 4, "level": "error", "attachments": [], "message": {"text": "Ensure rotation for customer created CMKs is enabled"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "kms.tf"}, "region": {"startLine": 166, "endLine": 249, "snippet": {"text": "resource \"aws_kms_key\" \"fail2\" {\n  description                        = \"fail2\"\n  deletion_window_in_days            = 7\n  key_usage                          = \"ENCRYPT_DECRYPT\"\n  customer_master_key_spec           = \"SYMMETRIC_DEFAULT\"\n  policy                             = <<POLICY\n{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Sid\": \"ABasicBadPolicyExampleTest\",\n            \"Effect\": \"Allow\",\n            \"Principal\": {\n                \"AWS\": \"*\"\n            },\n            \"Action\": [\n                \"kms:Update*\",\n                \"kms:UntagResource\",\n                \"kms:TagResource\",\n                \"kms:SynchronizeMultiRegionKey\",\n                \"kms:ScheduleKeyDeletion\",\n                \"kms:ReplicateKey\",\n                \"kms:PutKeyPolicy\",\n                \"kms:List*\",\n                \"kms:Get*\",\n                \"kms:Enable*\",\n                \"kms:Disable*\",\n                \"kms:Describe*\",\n                \"kms:DeleteAlias\",\n                \"kms:CreateAlias\",\n                \"kms:CancelKeyDeletion\"\n            ],\n            \"Resource\": \"*\"\n        },\n        {\n            \"Sid\": \"AllowMacietoDecryptheKey\",\n            \"Effect\": \"Allow\",\n            \"Principal\": {\n                \"AWS\": \"arn:aws:iam::398930073421:root\"\n            },\n            \"Action\": [\n                \"kms:List*\",\n                \"kms:GetKeyRotationStatus\",\n                \"kms:GetKeyPolicy\",\n                \"kms:Describe*\",\n                \"kms:Decrypt\"\n            ],\n            \"Resource\": \"*\",\n            \"Condition\": {\n                \"StringEquals\": {\n                    \"aws:PrincipalArn\": \"arn:aws:iam::398930073421:role/aws-service-role/macie.amazonaws.com/AWSServiceRoleForAmazonMacie\"\n                }\n            }\n        },\n        {\n            \"Sid\": \"AllowConfigandAccessAnalyzertoReadKeyAttributes\",\n            \"Effect\": \"Allow\",\n            \"Principal\": {\n                \"AWS\": \"arn:aws:iam::398930073421:root\"\n            },\n            \"Action\": [\n                \"kms:List*\",\n                \"kms:GetKeyRotationStatus\",\n                \"kms:GetKeyPolicy\",\n                \"kms:Describe*\"\n            ],\n            \"Resource\": \"*\",\n            \"Condition\": {\n                \"StringEquals\": {\n                    \"aws:PrincipalArn\": [\n                        \"arn:aws:iam::398930073421:role/aws-service-role/access-analyzer.amazonaws.com/AWSServiceRoleForAccessAnalyzer\",\n                        \"arn:aws:iam::398930073421:role/aws-service-role/config.amazonaws.com/AWSServiceRoleForConfig\"\n                    ]\n                }\n            }\n        }\n    ]\n}\nPOLICY\n  bypass_policy_lockout_safety_check = false\n  is_enabled                         = false\n  enable_key_rotation                = false\n\n}\n"}}}}]}, {"ruleId": "CKV_AWS_227", "ruleIndex": 5, "level": "error", "attachments": [], "message": {"text": "Ensure KMS key is enabled"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "kms.tf"}, "region": {"startLine": 166, "endLine": 249, "snippet": {"text": "resource \"aws_kms_key\" \"fail2\" {\n  description                        = \"fail2\"\n  deletion_window_in_days            = 7\n  key_usage                          = \"ENCRYPT_DECRYPT\"\n  customer_master_key_spec           = \"SYMMETRIC_DEFAULT\"\n  policy                             = <<POLICY\n{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Sid\": \"ABasicBadPolicyExampleTest\",\n            \"Effect\": \"Allow\",\n            \"Principal\": {\n                \"AWS\": \"*\"\n            },\n            \"Action\": [\n                \"kms:Update*\",\n                \"kms:UntagResource\",\n                \"kms:TagResource\",\n                \"kms:SynchronizeMultiRegionKey\",\n                \"kms:ScheduleKeyDeletion\",\n                \"kms:ReplicateKey\",\n                \"kms:PutKeyPolicy\",\n                \"kms:List*\",\n                \"kms:Get*\",\n                \"kms:Enable*\",\n                \"kms:Disable*\",\n                \"kms:Describe*\",\n                \"kms:DeleteAlias\",\n                \"kms:CreateAlias\",\n                \"kms:CancelKeyDeletion\"\n            ],\n            \"Resource\": \"*\"\n        },\n        {\n            \"Sid\": \"AllowMacietoDecryptheKey\",\n            \"Effect\": \"Allow\",\n            \"Principal\": {\n                \"AWS\": \"arn:aws:iam::398930073421:root\"\n            },\n            \"Action\": [\n                \"kms:List*\",\n                \"kms:GetKeyRotationStatus\",\n                \"kms:GetKeyPolicy\",\n                \"kms:Describe*\",\n                \"kms:Decrypt\"\n            ],\n            \"Resource\": \"*\",\n            \"Condition\": {\n                \"StringEquals\": {\n                    \"aws:PrincipalArn\": \"arn:aws:iam::398930073421:role/aws-service-role/macie.amazonaws.com/AWSServiceRoleForAmazonMacie\"\n                }\n            }\n        },\n        {\n            \"Sid\": \"AllowConfigandAccessAnalyzertoReadKeyAttributes\",\n            \"Effect\": \"Allow\",\n            \"Principal\": {\n                \"AWS\": \"arn:aws:iam::398930073421:root\"\n            },\n            \"Action\": [\n                \"kms:List*\",\n                \"kms:GetKeyRotationStatus\",\n                \"kms:GetKeyPolicy\",\n                \"kms:Describe*\"\n            ],\n            \"Resource\": \"*\",\n            \"Condition\": {\n                \"StringEquals\": {\n                    \"aws:PrincipalArn\": [\n                        \"arn:aws:iam::398930073421:role/aws-service-role/access-analyzer.amazonaws.com/AWSServiceRoleForAccessAnalyzer\",\n                        \"arn:aws:iam::398930073421:role/aws-service-role/config.amazonaws.com/AWSServiceRoleForConfig\"\n                    ]\n                }\n            }\n        }\n    ]\n}\nPOLICY\n  bypass_policy_lockout_safety_check = false\n  is_enabled                         = false\n  enable_key_rotation                = false\n\n}\n"}}}}]}, {"ruleId": "CKV_AWS_33", "ruleIndex": 6, "level": "error", "attachments": [], "message": {"text": "Ensure KMS key policy does not contain wildcard (*) principal"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "kms.tf"}, "region": {"startLine": 166, "endLine": 249, "snippet": {"text": "resource \"aws_kms_key\" \"fail2\" {\n  description                        = \"fail2\"\n  deletion_window_in_days            = 7\n  key_usage                          = \"ENCRYPT_DECRYPT\"\n  customer_master_key_spec           = \"SYMMETRIC_DEFAULT\"\n  policy                             = <<POLICY\n{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Sid\": \"ABasicBadPolicyExampleTest\",\n            \"Effect\": \"Allow\",\n            \"Principal\": {\n                \"AWS\": \"*\"\n            },\n            \"Action\": [\n                \"kms:Update*\",\n                \"kms:UntagResource\",\n                \"kms:TagResource\",\n                \"kms:SynchronizeMultiRegionKey\",\n                \"kms:ScheduleKeyDeletion\",\n                \"kms:ReplicateKey\",\n                \"kms:PutKeyPolicy\",\n                \"kms:List*\",\n                \"kms:Get*\",\n                \"kms:Enable*\",\n                \"kms:Disable*\",\n                \"kms:Describe*\",\n                \"kms:DeleteAlias\",\n                \"kms:CreateAlias\",\n                \"kms:CancelKeyDeletion\"\n            ],\n            \"Resource\": \"*\"\n        },\n        {\n            \"Sid\": \"AllowMacietoDecryptheKey\",\n            \"Effect\": \"Allow\",\n            \"Principal\": {\n                \"AWS\": \"arn:aws:iam::398930073421:root\"\n            },\n            \"Action\": [\n                \"kms:List*\",\n                \"kms:GetKeyRotationStatus\",\n                \"kms:GetKeyPolicy\",\n                \"kms:Describe*\",\n                \"kms:Decrypt\"\n            ],\n            \"Resource\": \"*\",\n            \"Condition\": {\n                \"StringEquals\": {\n                    \"aws:PrincipalArn\": \"arn:aws:iam::398930073421:role/aws-service-role/macie.amazonaws.com/AWSServiceRoleForAmazonMacie\"\n                }\n            }\n        },\n        {\n            \"Sid\": \"AllowConfigandAccessAnalyzertoReadKeyAttributes\",\n            \"Effect\": \"Allow\",\n            \"Principal\": {\n                \"AWS\": \"arn:aws:iam::398930073421:root\"\n            },\n            \"Action\": [\n                \"kms:List*\",\n                \"kms:GetKeyRotationStatus\",\n                \"kms:GetKeyPolicy\",\n                \"kms:Describe*\"\n            ],\n            \"Resource\": \"*\",\n            \"Condition\": {\n                \"StringEquals\": {\n                    \"aws:PrincipalArn\": [\n                        \"arn:aws:iam::398930073421:role/aws-service-role/access-analyzer.amazonaws.com/AWSServiceRoleForAccessAnalyzer\",\n                        \"arn:aws:iam::398930073421:role/aws-service-role/config.amazonaws.com/AWSServiceRoleForConfig\"\n                    ]\n                }\n            }\n        }\n    ]\n}\nPOLICY\n  bypass_policy_lockout_safety_check = false\n  is_enabled                         = false\n  enable_key_rotation                = false\n\n}\n"}}}}]}, {"ruleId": "CKV_AWS_7", "ruleIndex": 4, "level": "error", "attachments": [], "message": {"text": "Ensure rotation for customer created CMKs is enabled"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "kms.tf"}, "region": {"startLine": 635, "endLine": 637, "snippet": {"text": "resource \"aws_kms_key\" \"fail5\" {\n  description = \"fail5\"\n}\n"}}}}]}]}]}